build:
  context: .
  dockerfile: Dockerfile

deploy:
  startCommand: >
    sh -c "
      python manage.py migrate --noinput &&
      python manage.py collectstatic --noinput &&
      python manage.py load_csv data/filtered-data-es.csv --force || true &&
      gunicorn config.wsgi:application --bind 0.0.0.0:$PORT
    "
  healthcheckPath: /api/v1/installations/sports/
  healthcheckTimeout: 30
  restartPolicyType: always
